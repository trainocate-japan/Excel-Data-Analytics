{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 【補足】06. 分析結果の可視化"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "データ分析を進める上で、データの可視化や統計量の確認の重要度はこれまででわかりました。\n",
    "データ分析を援助するツールである BI ツールの基礎的な使用方法について紹介します。  \n",
    "\n",
    "\n",
    "まずはホテルのレビューデータを使用し、PowerBIの操作に慣れましょう。  \n",
    "一般的なホテルの宿泊に関するレビューのデータです。\n",
    "総合満足度の他に、お客様の属性や食事の満足度など各サービスに対する評価 (低1-5高) が入ったデータです。\n",
    "\n",
    "![01](img/07/01.png) \n",
    "\n",
    "\n",
    "## Power BI を使用した可視化\n",
    "\n",
    "Power BI は関連性のないデータソースを一貫性のある視覚的にイマーシブでインタラクティブな洞察に変えるために、連携して動作するソフトウェア サービス、アプリ、コネクタのコレクションです。データがシンプルな Microsoft Excel ワークブックであっても、クラウドベースおよびオンプレミスのハイブリッド データ ウェアハウスのコレクションであっても、Power BI を使用すると、データソースに簡単に接続して、基になるソースに影響を及ぼすことなく、データをクリーンアップおよびモデル化したり、重要なデータを可視化 (または発見) したり、あらゆる必要なユーザー全員とデータを共有したりできます。\n",
    "PowerBI は可視化ツールとしての印象が強いですが、可視化以外にも分析などを行うことが可能です。\n",
    "\n",
    "![02](img/07/02.png) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Power BI は、Power BI Desktop と呼ばれる Microsoft Windows デスクトップ アプリケーション、Power BI サービスと呼ばれるオンライン SaaS (サービスとしてのソフトウェア) サービス、および携帯電話やタブレットで使用できるモバイル Power BI アプリ(PowerBI Mobile) で構成されます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Power BI の使用手順\n",
    "使用手順は下記の通りです。\n",
    "\n",
    "![02](https://accessanalytic.com.au/wp-content/uploads/2016/09/Power-BI-Overview-Clear-1024x721.png)\n",
    "\n",
    "1. Power BI Desktop にデータを取り込み、レポートを作成します。\n",
    "\n",
    "2. Power BI サービスに発行して、新しい視覚エフェクトを作成したり、ダッシュボードを作成したりできます。\n",
    "\n",
    "3. 他のユーザー、特に外出先のユーザーとダッシュボードを共有します。\n",
    "\n",
    "4. Power BI Mobile アプリで共有ダッシュボードおよびレポートを表示および操作します。\n",
    "\n",
    "例えば、工場などでリアルタイムなデータを取得しそれを常に携帯などの IOT デバイスで確認することが可能です。\n",
    "Power BI Desktop は Windows のみの提供のため、Mac をご利用の方は Web 版を使用してください。\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## PowerBI の実装\n",
    "\n",
    "BI ツールを使用しデータから新たな傾向を見つけ出しましょう。\n",
    "\n",
    "Power BI Desktop もしくは Power BI (Web) を開いてください。\n",
    "Desktop と Web 版でデータの取得の方法が異なるので注意してください"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 【補足】Power BI Desktop のセットアップ\n",
    "Exel からデータの読み込みを行い、実装を行う準備をします。まずは Power BI Desktop を起動させてください。\n",
    "こちらのファイル使用してください。\n",
    "  \n",
    "[ホテルレビュー](img/07/ホテルレビュー.csv)\n",
    "\n",
    "ホーム画面からデータの取得を選択しダウンロードしたデータを選択してください。 \n",
    "\n",
    "![03](img/07/03.png) \n",
    "\n",
    "データにチェックをいれて読み込みをクリックしてください。 \n",
    "\n",
    "![04](img/07/04.png) \n",
    "\n",
    "読み込みが完了すると画像のようにフィールドに変数が表示されます。こちらのワークスペースを使用し実装を行います。 \n",
    "\n",
    "![05](img/07/05.png) \n",
    "\n",
    "データの可視化から実装を行います。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## PowerBI　Web のセットアップ\n",
    "\n",
    "[PowerBI Web のサイト](https://app.fabric.microsoft.com/groups/me/quickcreate?experience=power-bi)\n",
    "\n",
    "ご自身の MS アカウントにてログイン後、ホーム画面にてデータの取得先を選択できます。\n",
    "\n",
    "[ホテルレビュー.csv](img/ホテルレビュー.csv)\n",
    "\n",
    "データのダウンロードが完了しましたら、Power BI にデータのアップロードを行います。 Power BI を開いていただき、左上の【新しいレポート】を選択してください。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "csv を選択してください。先程ダウンロードをしました、ホテルレビュー.csv を選択しアップロードしてください。\n",
    "\n",
    "![07](img/07/0700.jpg) \n",
    "\n",
    "アップロードの設定は画像のようになります。\n",
    "\n",
    "![07-1](img/07/07-1.jpg)\n",
    "\n",
    "画像のようにレポートとデータセットの表示がされてましたら完了です。*表示されない場合は次のステップに進んで頂いて構いません。\n",
    "次にレポートを選択してください。\n",
    "\n",
    "![08](img/07/08.png) \n",
    "\n",
    "すると Workspace を開くことができます。 \n",
    "データを見てみるとホテルレビューの分析で使用したものと同じカラムが入っていることが確認できます。こちらでデータの可視化の実装を行います。\n",
    "\n",
    "![10](img/07/10.png) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## データの可視化\n",
    "こちらからの操作は Power BI Desktop, Power BI どちらを使用している方も同様となります\n",
    "\n",
    "### 円グラフ\n",
    "それでは Power BI を使用してデータの可視化を行います。\n",
    "満足度の割合を確認します。視覚化ウィンドウから円グラフを選択します。\n",
    "すると画像のように表示がされます。この時点ではどのようなデータを表示させるのか定義をしていないので画像のような形になります。\n",
    "\n",
    "![11](img/07/11.png) \n",
    "\n",
    "次に表示させるデータを選択します。満足度を選択し値の部分に挿入てください。\n",
    "すると画像のように表示されます\n",
    "\n",
    "![12](img/07/12.png) \n",
    "\n",
    "これでは割合を確認することができません。 値の表示方法を変更します。値の満足度をクリックしてください。\n",
    "\n",
    "![13](img/07/13.png) \n",
    "\n",
    "カウントにチェックいれます。\n",
    "\n",
    "![14](img/07/14.png) \n",
    "\n",
    "その後凡例に満足度をドラッグ・アンド・ドロップし、再度表示を確認します。\n",
    "\n",
    "![15](img/07/15.png) \n",
    "\n",
    "すると下記のように満足度の 1~5 のアンケート結果の割合を表示させることができました。\n",
    "\n",
    "![16](img/07/16.png) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "続けて、旅行の目的の可視化と Wifi 設備を可視化を行います。\n",
    "旅行の目的は先程と同様に円グラフを使用しますので是非一度、動画を止めて実装を行ってください。\n",
    "\n",
    "![17](img/07/17.png) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "旅行の目的の可視化は下記のようになります。わからなくなってしまった方はもう一度、円グラフの作成方法を確認してみてください。\n",
    "割合が Exel と同じ割合になりましたら正解です。\n",
    "\n",
    "![18](img/07/18.png) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ヒストグラム\n",
    "\n",
    "次に Wifi 設備を Exel で実装した際と同じように可視化します。 視覚化ウィンドウから積み上げ縦棒グラフを選択してください。\n",
    "\n",
    "![19](img/07/19.png) \n",
    "\n",
    "ヒストグラムを整形するために必要な軸、凡例、値の情報を受け渡します。\n",
    "凡例は値を渡さなくても実装できますがより理解しやすくするために入力をしています。3つの変数を使用し可視化をして分析を行う際にも有効です。\n",
    "\n",
    "![20](img/07/20.png) \n",
    "\n",
    "正しくデータが渡されると画像のように可視化を行うことができます。\n",
    "\n",
    "![21](img/07/21.png) \n",
    "\n",
    "次に 2 つの変数を使用し可視化を行います。\n",
    "満足度とホテルの立地の平均値を可視化します。\n",
    "再度ヒストグラムを選択してください。軸、凡例、値には下記を入力してください。\n",
    "\n",
    "![22](img/07/22.png) \n",
    "\n",
    "こちらが可視化結果です。\n",
    "\n",
    "![23](img/07/23.png) \n",
    "\n",
    "満足度の低いお客様はホテルの立地に対する評価も満足度5の平均と比べると低い傾向がありますが、満足度に関しまして 1,2,3 をつけたお客様のなかで3をつけたお客様がホテルの立地に対する平均の評価が最も低いという結果でした。\n",
    "\n",
    "- 満足度に反してホテルの立地への評価が高いことからお客様へのサービスが十分でない可能性が考えられる。データにはないが、ホテルの稼働率などを見ることによって従業員が足りていないなどの原因を特定できる。\n",
    "- 3 をつけたお客様はホテル選びの際に立地をある程度重視していたが期待していたほどのホテル立地ではなかった可能性があり、そのためホテルに来られる前からネガティブな印象をお持ちであったかもしれない。立地が満足度が向上しない要因である可能性がある。\n",
    "\n",
    "\n",
    "１例ではありますが上記のような仮説や考察をたてることができます。\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### PowerBI を用いた高度な分析\n",
    "\n",
    "ここまで基礎的な Power BI の実装方法についてご紹介いたしました。\n",
    "他にも Power BI ではデータの説明の補助、分析の補助をするためのツールがありますのでそちらについてご紹介致します。\n",
    "\n",
    "### 主要なインフルエンサー\n",
    "主要なインフルエンサーは、関心のある変数（ホテルのレビュー）を動作させる要因を理解するのに役立ちます。 データを分析し、重要な要因にランクを付け、主要なインフルエンサーとして表示します。重回帰などのデータ分析を行ったことがない方でも簡単に重要度を可視化できる便利なツールです。\n",
    "便利な反面、ブラックボックスな要素が多く、重要度を算出する上でどのような分析手法や計算を行ったのかがわかりません。\n",
    "視覚化ウィンドウから主要なインフルエンサーを選択します。\n",
    "\n",
    "![25](img/07/25.png) \n",
    "\n",
    "\n",
    "分析を行う対象は満足度なので画像のようにします。\n",
    "![26](img/07/26.png) \n",
    "\n",
    "分析後の重要度です。\n",
    "\n",
    "![27](img/07/27.png) \n",
    "\n",
    "こちらは滞在時の快適さが 1.32 上昇すると満足度に対しても 0.52 の上昇が見られるということを表しています。\n",
    "表示を変えることで満足度が下がってしまう要因の特定を行うことも可能です。使用されている分析手法のの詳細等は[こちら](https://dotnet.microsoft.com/en-us/platform/customers/power-bi)こちらをご確認ください。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ツリー\n",
    "ツリーは集計された値を任意の順序で探索することができます。アドホック探索や根本原因分析に役立つツールになります。 データサイエンスの知識がなくてもデータの深堀りを行い、メトリックの要因の特定を行うことが可能です。詳細はこちらをご確認ください。\n",
    "\n",
    "視覚化ウィンドウから分解ツリーを選択します。 \n",
    "\n",
    "![30](img/07/30.png) \n",
    "\n",
    "次に分析に使用するメトリックを決めます。今回は満足度の平均値に注目をし、立地の悪いホテルでも高い満足度を得ることが可能かどうかを検証します。使用する変数はホテル立地、wifi満足度、食事満足度です。 tree1.png\n",
    "\n",
    "画像のようにホテル立地に対して最低点の1の評価をつけたお客様でもwifiや食事といったサービスを充実させることによって平均以上の満足度を得ることが可能です。\n",
    "\n",
    "![31](img/07/31.png) \n",
    "\n",
    "また、実務で考えますと新しいホテルを建設する際に、立地の良いところに建設すべきなのかそれとも建設予算を押さえてその他のサービスに力を入れるべきなのかなど、様々な場面でのビジネス上の意思決定においても活用が可能です。\n",
    "\n",
    "![32](img/07/32.png) \n",
    "\n",
    "ここまで Power BI の基礎的な使用方法と活用場面について解説を行いました。データサイエンスだけではなく、意思決定を行う際の説明ツールとしても使用可能ですのでぜひ使用してください。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "時間のある方は、講座内で使用した Bank データを使用し、試行錯誤を行ってみてください。 "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 【補足】フィルター\n",
    "\n",
    "フィルタリング機能を使用することによってより範囲を絞って分析を行うことが可能です。 今回は年齢が75歳より上の人という条件をつけ、結果を確認します。\n",
    "\n",
    "フィルターの使用方法は使用したい変数をフィルタにドラッグ・アンド・ドロップをし、基準となる値を選択もしくは入力します。\n",
    "\n",
    "![24](img/07/24.png) \n",
    "\n",
    "すこしわかりにくいですが、満足度 2 と答えたお客様の立地の平均スコアを確認したところ、 4 以上のスコアを確認しました。\n",
    "こちらのグラフだけでは考察が難しいですが、\n",
    "- 75歳以上のお客様はより立地よりもより、サービス面を評価し満足度が決まっているという可能性が考えられます。\n",
    "\n",
    "フィルター機能も合わせて使用することによってデータの背後にある関係性を見つけ出すことができ、視覚的に説明をすることが可能となります。\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": []
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
